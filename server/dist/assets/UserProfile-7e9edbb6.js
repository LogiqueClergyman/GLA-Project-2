import{ag as t,af as G,ae as Y,an as _,ao as d,ah as e,ak as r,ap as y}from"./index-5036fb59.js";import{u as H}from"./upload-ecfa5787.js";const X=()=>{const[l,u]=t.useState([]),[J,N]=t.useState([]),[v,w]=t.useState([]),[m,I]=t.useState([]),[c,h]=t.useState(null),[C,k]=t.useState(""),f=G(),D=Y(),g=_(),S=g.state&&g.state.email,x=d(s=>s.userData.profileImage),i=d(s=>s.userData.email),[M,p]=t.useState(!1),[z,j]=t.useState(!1),[K,T]=t.useState(null);t.useState(null);const[O,b]=t.useState(!1),E=d(s=>s.userData.details);t.useEffect(()=>u(E),[]);const U=async s=>{try{const a=localStorage.getItem("token"),o=await r.post("/cource/getMyCourses",{email:s},{headers:{Authorization:`Bearer ${a}`}});console.log(o.data),u(o.data.user),!x&&o.data.user.email===i&&f(y(o.data.user.profileImage)),w(o.data.courses)}catch(a){console.error("Error fetching courses:",a)}},A=async s=>{p(!0),b(!0),console.log("going to request");const a=await r.post(`https://api.razorpay.com/v1/transactions/${s}`);console.log(a),T(a),b(!1)},P=s=>{j(!0)},R=async s=>{try{console.log(s);const a=localStorage.getItem("token"),o=await r.post("/cource/getCourses",{email:s},{headers:{Authorization:`Bearer ${a}`}});console.log(o.data.courses),N(o.data.courses)}catch(a){console.error("Error fetching courses:",a)}},$=async s=>{try{const a=localStorage.getItem("token"),o=await r.post("/getTxns",{email:s},{headers:{Authorization:`Bearer ${a}`}});I(o.data)}catch(a){return console.error("Error fetching transactions:",a),a}},B=s=>{h(s.target.files[0])},F=async()=>{try{const{url:s}=await H(c);return console.log(s),k(s),f(y(s)),L(s),s}catch(s){return console.error("Error uploading image:",s),null}},L=async s=>{try{console.log(C);const a=localStorage.getItem("token"),o=await r.put("/updateProfileImage",{imageUrl:s},{headers:{Authorization:`Bearer ${a}`}});console.log(o.data),h("")}catch(a){console.log(a)}};function q(s){return(new Date().getTime()-new Date(s).getTime())/(1e3*3600*24)>7}const n=S||i;return t.useEffect(()=>{console.log(n),R(n),U(n),$(n)},[]),t.useEffect(()=>{c!==null&&F()},[c]),e.jsx("div",{className:"bg-blue-100",children:e.jsxs("main",{className:" mx-auto py-8 md:px-8 px-4 grid grid-cols-1 md:grid-cols-2 gap-8",children:[e.jsxs("div",{className:"border rounded-md bg-white md:p-6 p-3 md:mb-6 mb-3 h-full",children:[e.jsx("h2",{className:"text-lg font-bold mb-4",children:"Profile"}),e.jsxs("div",{className:"border rounded-md p-4 mb-4",children:[e.jsx("label",{htmlFor:"dropzone-file",className:"flex justify-center",children:e.jsxs("div",{className:"md:w-1/2  border-2 p-2 rounded-xl",children:[e.jsx("img",{src:`${l.email===i?x:l.profileImage}`,alt:"User Profile",className:"  object-cover rounded-full h-[20rem] w-[20rem]"}),e.jsx("input",{id:"dropzone-file",onChange:B,type:"file",className:"hidden"})]})}),e.jsxs("div",{className:"p-4 flex flex-col items-center",children:[e.jsx("p",{children:l.role==="Super Admin"&&e.jsx("span",{className:"font-semibold text-red-500",children:"Category: Master"})}),e.jsx("p",{children:l.role==="Admin"&&e.jsx("span",{className:"font-semibold text-red-500",children:"Category: Teacher"})}),e.jsx("p",{children:l.role==="User"&&e.jsx("span",{className:"font-semibold text-red-500",children:"Category: Student"})}),e.jsxs("p",{children:[e.jsx("span",{className:"font-bold",children:"Name: "})," ",l.name]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-bold",children:"Email: "})," ",l.email]})]})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"border rounded-md bg-white p-6 mb-6",children:[e.jsx("h2",{className:"text-lg font-bold mb-4",children:"My Cource:"}),e.jsx("div",{className:"grid grid-cols-2 gap-4 overflow-auto max-h-[500px]",children:v.map(s=>e.jsxs("div",{onClick:()=>{D("/myCourse")},className:"border rounded-md overflow-hidden h-52",children:[e.jsxs("video",{controls:!0,className:"w-full h-40 object-cover",children:[e.jsx("source",{src:s.courseUrl,type:"video/mp4"}),"Your browser does not support the video tag."]}),e.jsx("div",{className:"p-4",children:e.jsx("h3",{className:"text-lg font-bold mb-2",children:s.title})})]},s._id))})]}),e.jsx("div",{children:e.jsxs("div",{className:"border rounded-md bg-white p-6 mb-6",children:[e.jsx("h2",{className:"text-lg font-bold mb-4",children:"My Purchases:"}),e.jsxs("table",{className:"w-full",children:[e.jsxs("th",{className:" flex justify-between w-full",children:[e.jsx("td",{children:"Course Title"}),e.jsx("td",{children:"Type"}),e.jsx("td",{children:"Details"}),e.jsx("td",{children:"Refund"})]}),m.length>0&&m.map(s=>e.jsxs("tr",{className:"w-full justify-between flex",children:[e.jsx("td",{children:s.courseTitle}),e.jsx("td",{children:s.hash.length==0?"INR":"Crypto"}),e.jsx("td",{children:e.jsx("button",{onClick:()=>{A(s)},children:"Details"})}),e.jsx("td",{children:e.jsx("button",{disabled:s.hash.length==0||q(s.createdAt),onClick:()=>{P()},children:"Refund"})})]}))]})]})})]}),M&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 z-20 bg-black opacity-80",onClick:()=>{console.log("modal close click"),p(!1)}}),e.jsx("div",{className:"fixed z-30 flex justify-center w-full",children:e.jsx("div",{className:"bg-white w-[] text-black",children:"hello"})})]}),z&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 z-20 bg-black opacity-80",onClick:()=>{console.log("modal close click"),j(!1)}}),e.jsx("div",{className:"fixed z-30 flex justify-center w-full",children:e.jsx("div",{className:"bg-white w-[] text-black",children:"hello"})})]})]})})};export{X as default};
